- id: b1782abc.430f38
  type: tab
  label: Sensors-WebRelay
  disabled: false
  info: ''
- id: add1e3abafaf542e
  type: junction
  z: b1782abc.430f38
  x: 990
  'y': 540
  wires:
    - - 1ba94549.ae6bdb
- id: a170f2c794c496b3
  type: junction
  z: b1782abc.430f38
  x: 990
  'y': 510
  wires:
    - - 7828567a6b1e35ab
- id: 0edaade20969311b
  type: junction
  z: b1782abc.430f38
  x: 1190
  'y': 790
  wires:
    - - 3e4d792744058a92
      - a04282091d8972bc
- id: 24374a202cb2eaec
  type: junction
  z: b1782abc.430f38
  x: 370
  'y': 1110
  wires:
    - - 741678fd.3f4f18
- id: e2c89ae6.57aa1
  type: http request
  z: b1782abc.430f38
  name: Web Relays
  method: GET
  ret: obj
  paytoqs: ignore
  url: 'http://ioteleinfo.local/status'
  tls: ''
  persist: true
  proxy: ''
  authType: ''
  x: 360
  'y': 90
  wires:
    - - 7c54b8f2.2432a
      - 7e2f7c263a132298
- id: 1757f9f9.180a86
  type: inject
  z: b1782abc.430f38
  name: Poll Web Relays (60s)
  repeat: '60'
  crontab: ''
  once: false
  onceDelay: ''
  topic: ''
  payload: ''
  payloadType: str
  x: 150
  'y': 90
  wires:
    - - e2c89ae6.57aa1
- id: bf66c587.e16b18
  type: mqtt out
  z: b1782abc.430f38
  name: sensors/xxx/nodes/...
  topic: ''
  qos: ''
  retain: ''
  broker: c38452a5.4f84e8
  x: 810
  'y': 60
  wires: []
- id: 220263b.bb9aa1c
  type: catch
  z: b1782abc.430f38
  name: ''
  scope: null
  uncaught: false
  x: 100
  'y': 30
  wires:
    - - 5d10dd0b.1db574
- id: 5d10dd0b.1db574
  type: link out
  z: b1782abc.430f38
  name: General CatchAll
  links:
    - 1bf42829.b3e0b8
  x: 255
  'y': 30
  wires: []
- id: 7c54b8f2.2432a
  type: debug
  z: b1782abc.430f38
  name: ''
  active: false
  tosidebar: true
  console: false
  tostatus: false
  complete: 'false'
  statusVal: ''
  statusType: auto
  x: 540
  'y': 140
  wires: []
- id: a7d2ebd0.4c12a
  type: inject
  z: b1782abc.430f38
  name: 01 - Bureau
  props:
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: ''
  topic: '1'
  x: 110
  'y': 1010
  wires:
    - - 24374a202cb2eaec
- id: 6c6e6c5d.0ac7ac
  type: inject
  z: b1782abc.430f38
  name: 00 - SdJ
  props:
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: ''
  topic: '0'
  x: 100
  'y': 970
  wires:
    - - 24374a202cb2eaec
- id: bb55b46b.570be8
  type: inject
  z: b1782abc.430f38
  name: 02 - Chambre L.
  props:
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: ''
  topic: '2'
  x: 120
  'y': 1050
  wires:
    - - 24374a202cb2eaec
- id: 9f42607e.9d9368
  type: inject
  z: b1782abc.430f38
  name: 03 - Chambre D.
  props:
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: ''
  topic: '3'
  x: 120
  'y': 1090
  wires:
    - - 24374a202cb2eaec
- id: abc37c81.f3592
  type: inject
  z: b1782abc.430f38
  name: 04 - SdB - Haut
  props:
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: ''
  topic: '4'
  x: 120
  'y': 1130
  wires:
    - - 24374a202cb2eaec
- id: cdcf4c5a.dce938
  type: inject
  z: b1782abc.430f38
  name: 05 - Mezanine
  props:
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: ''
  topic: '5'
  x: 110
  'y': 1170
  wires:
    - - 24374a202cb2eaec
- id: 5f8460fe.a89da
  type: inject
  z: b1782abc.430f38
  name: 06 - Chambre P/M
  props:
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: ''
  topic: '6'
  x: 130
  'y': 1210
  wires:
    - - 24374a202cb2eaec
- id: 883e7994.d94b68
  type: inject
  z: b1782abc.430f38
  name: 14 - Salon
  props:
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: ''
  topic: '14'
  x: 100
  'y': 1280
  wires:
    - - 24374a202cb2eaec
- id: 930f4fce.94c2d8
  type: inject
  z: b1782abc.430f38
  name: 15 - Hall
  props:
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: ''
  topic: '15'
  x: 100
  'y': 1320
  wires:
    - - 24374a202cb2eaec
- id: 558d963e.cb324
  type: comment
  z: b1782abc.430f38
  name: IOTHeaters - Test
  info: ''
  x: 120
  'y': 930
  wires: []
- id: aab849a7.ee2658
  type: mqtt out
  z: b1782abc.430f38
  name: actors/iotheaters/switch
  topic: actors/iotheaters/switch
  qos: ''
  retain: ''
  respTopic: ''
  contentType: ''
  userProps: ''
  correl: ''
  expiry: ''
  broker: c38452a5.4f84e8
  x: 960
  'y': 1110
  wires: []
- id: 741678fd.3f4f18
  type: change
  z: b1782abc.430f38
  name: ''
  rules:
    - t: set
      p: payload
      pt: msg
      to: '{}'
      tot: json
    - t: set
      p: payload.id
      pt: msg
      to: topic
      tot: msg
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 670
  'y': 1110
  wires:
    - - aab849a7.ee2658
      - e790a499.f53248
- id: 9c1a2185.ace048
  type: link in
  z: b1782abc.430f38
  name: WebRelaysIn
  links: []
  x: 295
  'y': 970
  wires:
    - - 24374a202cb2eaec
- id: c269b719.1c237
  type: link in
  z: b1782abc.430f38
  name: WebRelaysInLatch
  links:
    - 7dfb853e.03a1f4
    - 1fd6723.fc4360e
  x: 245
  'y': 1360
  wires:
    - - d5867a8d.091
- id: e790a499.f53248
  type: debug
  z: b1782abc.430f38
  name: ''
  active: false
  console: 'false'
  complete: 'true'
  x: 900
  'y': 1070
  wires: []
- id: 9a182caa.06e45
  type: debug
  z: b1782abc.430f38
  name: ''
  active: false
  tosidebar: true
  console: false
  tostatus: false
  complete: 'true'
  targetType: full
  statusVal: ''
  statusType: auto
  x: 640
  'y': 1220
  wires: []
- id: 50816b6.a434a94
  type: inject
  z: b1782abc.430f38
  name: 08 - Portail
  props:
    - p: payload
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: false
  onceDelay: 0.1
  topic: '8'
  payload: ''
  payloadType: date
  x: 200
  'y': 1400
  wires:
    - - d5867a8d.091
- id: deb0a59.85d1458
  type: trigger
  z: b1782abc.430f38
  name: Portail Clic
  op1: ''
  op2: ''
  op1type: nul
  op2type: pay
  duration: '1'
  extend: true
  overrideDelay: false
  units: s
  reset: ''
  bytopic: all
  topic: topic
  outputs: 1
  x: 660
  'y': 1180
  wires:
    - - ae57d3a3.e3fe88
      - 741678fd.3f4f18
- id: ae57d3a3.e3fe88
  type: debug
  z: b1782abc.430f38
  name: ''
  active: false
  tosidebar: true
  console: false
  tostatus: false
  complete: 'true'
  targetType: full
  statusVal: ''
  statusType: auto
  x: 900
  'y': 1180
  wires: []
- id: d5867a8d.091
  type: change
  z: b1782abc.430f38
  name: ''
  rules:
    - t: set
      p: payload
      pt: msg
      to: ''
      tot: date
    - t: set
      p: topic
      pt: msg
      to: '8'
      tot: str
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 370
  'y': 1400
  wires:
    - - deb0a59.85d1458
      - 9a182caa.06e45
      - 741678fd.3f4f18
- id: e2d7dc14.f1a8a8
  type: comment
  z: b1782abc.430f38
  name: Actors - MQTT push
  info: ''
  x: 130
  'y': 170
  wires: []
- id: dda2b638.2a5f7
  type: mqtt in
  z: b1782abc.430f38
  name: actors/iotheaters/switch
  topic: actors/iotheaters/switch
  qos: '2'
  datatype: json
  broker: c38452a5.4f84e8
  inputs: 0
  x: 140
  'y': 210
  wires:
    - - f8329ea7.84c6d8
- id: f8329ea7.84c6d8
  type: http request
  z: b1782abc.430f38
  name: Switch Web Relays
  method: GET
  ret: txt
  paytoqs: ignore
  url: 'http://ioteleinfo.local/relays/set?id={{{payload.id}}}&value=-1'
  tls: ''
  persist: false
  proxy: ''
  insecureHTTPParser: false
  authType: ''
  senderr: false
  headers: []
  x: 570
  'y': 210
  wires:
    - - eeed3c1e.9602e8
- id: eeed3c1e.9602e8
  type: debug
  z: b1782abc.430f38
  name: ''
  active: false
  console: 'false'
  complete: 'true'
  x: 800
  'y': 210
  wires: []
- id: a9a5a446.2c7cb
  type: websocket in
  z: b1782abc.430f38
  name: WebRelay
  server: ''
  client: '26438802.204788'
  x: 100
  'y': 380
  wires:
    - - 2812070e.894da8
      - ac2d43ea.e2eaf
      - 67d26f68.ac9028
      - c97606c5.d54558
- id: 1ba94549.ae6bdb
  type: mqtt out
  z: b1782abc.430f38
  name: sensors
  topic: sensors
  qos: ''
  retain: ''
  broker: c38452a5.4f84e8
  x: 1110
  'y': 570
  wires: []
- id: 6efd389b.03b1
  type: switch
  z: b1782abc.430f38
  name: sensors value
  property: sensors
  propertyType: msg
  rules:
    - t: hask
      v: temperature
      vt: str
    - t: hask
      v: humidity
      vt: str
    - t: else
  checkall: 'true'
  repair: false
  outputs: 3
  x: 490
  'y': 510
  wires:
    - - b629ec5a.2b4f78
    - - 16258a34.5ce016
    - - f080b42a.8ae208
- id: b629ec5a.2b4f78
  type: function
  z: b1782abc.430f38
  name: Sensors-Temperature
  func: |-
    var msgres =  {
        payload: {
            topic: "teleinfo-temperature-wr-Garage",
            payload: [
                { "value": Number(msg.sensors.temperature) },
                { "type": "temperature", "location": "wr-Garage" }
            ],
            measurement: "sensors"
        }
    }

    return msgres;
  outputs: 1
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 850
  'y': 500
  wires:
    - - add1e3abafaf542e
      - a170f2c794c496b3
- id: 16258a34.5ce016
  type: function
  z: b1782abc.430f38
  name: Sensors-Humidity
  func: |-
    var msgres =  {
        payload: {
            topic: "teleinfo-humidity-wr-Garage",
            payload: [
                { "value": Number(msg.sensors.humidity) },
                { "type": "humidity", "location": "wr-Garage" }
            ],
            measurement: "sensors"
        }
    }

    return msgres;
  outputs: 1
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 840
  'y': 540
  wires:
    - - add1e3abafaf542e
      - a170f2c794c496b3
- id: 2812070e.894da8
  type: debug
  z: b1782abc.430f38
  name: WebRelayDebug
  active: false
  tosidebar: true
  console: false
  tostatus: false
  complete: 'true'
  targetType: full
  statusVal: ''
  statusType: auto
  x: 300
  'y': 660
  wires: []
- id: f080b42a.8ae208
  type: debug
  z: b1782abc.430f38
  name: SensorsDebug
  active: false
  tosidebar: true
  console: false
  tostatus: false
  complete: 'true'
  targetType: full
  statusVal: ''
  statusType: auto
  x: 830
  'y': 580
  wires: []
- id: ac2d43ea.e2eaf
  type: switch
  z: b1782abc.430f38
  name: relays
  property: relays
  propertyType: msg
  rules:
    - t: nnull
  checkall: 'true'
  repair: false
  outputs: 1
  x: 260
  'y': 620
  wires:
    - - b7f3c41.7550bb8
      - 7755fd51.b4d8f4
- id: d66f7b10.e7534
  type: function
  z: b1782abc.430f38
  name: Relays-OnOff
  func: |-
    var msgres =  {
        payload: {
            payload: [
                { "value": Number(msg.payload.value) },
                { "type": "plug-onoff", "location": "wr-Garage-" + msg.payload.id }
            ],
            measurement: "sensors"
        }
    }

    return msgres;
  outputs: 1
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 830
  'y': 620
  wires:
    - - 1ba94549.ae6bdb
- id: 7755fd51.b4d8f4
  type: debug
  z: b1782abc.430f38
  name: RelaysDebug
  active: false
  tosidebar: true
  console: false
  tostatus: false
  complete: 'true'
  targetType: full
  statusVal: ''
  statusType: auto
  x: 830
  'y': 660
  wires: []
- id: 67d26f68.ac9028
  type: switch
  z: b1782abc.430f38
  name: sensors
  property: sensors
  propertyType: msg
  rules:
    - t: nnull
  checkall: 'true'
  repair: false
  outputs: 1
  x: 270
  'y': 500
  wires:
    - - 6efd389b.03b1
- id: c97606c5.d54558
  type: switch
  z: b1782abc.430f38
  name: teleinfo
  property: teleinfo
  propertyType: msg
  rules:
    - t: nnull
  checkall: 'true'
  repair: false
  outputs: 1
  x: 270
  'y': 380
  wires:
    - - 1f15f03f0befad41
- id: 10349fb3.8e444
  type: split
  z: b1782abc.430f38
  name: ''
  splt: \n
  spltType: str
  arraySplt: 1
  arraySpltType: len
  stream: false
  addname: ''
  x: 650
  'y': 600
  wires:
    - - d66f7b10.e7534
- id: b7f3c41.7550bb8
  type: change
  z: b1782abc.430f38
  name: ''
  rules:
    - t: set
      p: payload
      pt: msg
      to: relays
      tot: msg
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 490
  'y': 600
  wires:
    - - 10349fb3.8e444
- id: a04282091d8972bc
  type: mqtt out
  z: b1782abc.430f38
  name: sensors
  topic: sensors
  qos: ''
  retain: ''
  respTopic: ''
  contentType: ''
  userProps: ''
  correl: ''
  expiry: ''
  broker: c38452a5.4f84e8
  x: 1300
  'y': 810
  wires: []
- id: 4041416e2b11e83f
  type: debug
  z: b1782abc.430f38
  name: WSTeleinfoDebug
  active: false
  tosidebar: true
  console: false
  tostatus: false
  complete: 'true'
  targetType: full
  statusVal: ''
  statusType: auto
  x: 190
  'y': 840
  wires: []
- id: 3e4d792744058a92
  type: debug
  z: b1782abc.430f38
  name: StorageDebug
  active: false
  tosidebar: true
  console: false
  tostatus: false
  complete: 'true'
  targetType: full
  statusVal: ''
  statusType: auto
  x: 1320
  'y': 770
  wires: []
- id: 8175abc180c732e4
  type: mqtt in
  z: b1782abc.430f38
  name: actors/iotheaters/set
  topic: actors/iotheaters/set
  qos: '2'
  datatype: json
  broker: c38452a5.4f84e8
  nl: false
  rap: false
  inputs: 0
  x: 130
  'y': 260
  wires:
    - - 6b78b06d6d132a3b
- id: bf76f115523ab776
  type: debug
  z: b1782abc.430f38
  name: ''
  active: false
  console: 'false'
  complete: 'true'
  x: 800
  'y': 260
  wires: []
- id: 046ac47846e9e56f
  type: http request
  z: b1782abc.430f38
  name: Set Web Relays
  method: GET
  ret: txt
  paytoqs: ignore
  url: >-
    http://ioteleinfo.local/relays/set?id={{{payload.id}}}&state={{{payload.value}}}
  tls: ''
  persist: false
  proxy: ''
  insecureHTTPParser: false
  authType: ''
  senderr: false
  headers: []
  x: 560
  'y': 260
  wires:
    - - bf76f115523ab776
- id: 6b78b06d6d132a3b
  type: delay
  z: b1782abc.430f38
  name: ''
  pauseType: rate
  timeout: '500'
  timeoutUnits: milliseconds
  rate: '1'
  nbRateUnits: '0.1'
  rateUnits: second
  randomFirst: '1'
  randomLast: '5'
  randomUnits: seconds
  drop: false
  allowrate: false
  outputs: 1
  x: 350
  'y': 260
  wires:
    - - 046ac47846e9e56f
- id: 7e2f7c263a132298
  type: function
  z: b1782abc.430f38
  name: Parse WebRelays
  func: |-
    // name: Parse web relays
    // outputs: 1
    var outputMsgs = []
    var displayMsg = ""
    var timestampH = new Date().toISOString()
    var timestamp = new Date().getTime()

    for (var i in msg.payload.relays) {
        
        let relayId = msg.payload.relays[i].id
        let relayDesc = msg.payload.relays[i].description
        let relayValue = msg.payload.relays[i].value
        let type = 'toggle'
        let entry = 0
        
        var msgS = {}
        msgS.topic = 'sensors/iotheaters/nodes/' + relayId + '/entries/' + entry + '/events/' + type;
        msgS.payload = { 
            "gateway":"iotheaters",
            "id": relayId,
            "entry": entry,
            "type": type,
            "value": relayValue,
            "timestamp": timestamp,
            "timestamp-human": timestampH
        }
        displayMsg += relayDesc + "(" + relayId + ")=" + relayValue + "; "
        outputMsgs.push(msgS);
    }

    node.status({ fill:"blue", shape:"dot", text: displayMsg });

    return [ outputMsgs ];
  outputs: 1
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 560
  'y': 80
  wires:
    - - bf66c587.e16b18
- id: 7828567a6b1e35ab
  type: trigger
  z: b1782abc.430f38
  name: Watchdog
  op1: ''
  op2: ''
  op1type: nul
  op2type: pay
  duration: '5'
  extend: true
  overrideDelay: false
  units: min
  reset: ''
  bytopic: topic
  topic: topic
  outputs: 1
  x: 1110
  'y': 510
  wires:
    - - 5b354d74db3c3466
- id: 5b354d74db3c3466
  type: debug
  z: b1782abc.430f38
  name: WR W Debug
  active: true
  tosidebar: true
  console: false
  tostatus: false
  complete: 'true'
  targetType: full
  statusVal: ''
  statusType: auto
  x: 1320
  'y': 510
  wires: []
- id: c65cb5485f659160
  type: split
  z: b1782abc.430f38
  name: ''
  splt: \n
  spltType: str
  arraySplt: 1
  arraySpltType: len
  stream: false
  addname: topic
  x: 280
  'y': 800
  wires:
    - - 9f6adedc9ca772ef
- id: bec90f8452d9f39a
  type: change
  z: b1782abc.430f38
  name: keys
  rules:
    - t: set
      p: payload
      pt: msg
      to: teleinfo
      tot: msg
      dc: true
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 150
  'y': 800
  wires:
    - - c65cb5485f659160
- id: 96a4ca6603fc71d9
  type: link in
  z: b1782abc.430f38
  name: Sensors-WebRelays-Teleinfo
  links:
    - 1f15f03f0befad41
  x: 55
  'y': 800
  wires:
    - - bec90f8452d9f39a
      - 4041416e2b11e83f
- id: 174f858dfae1238b
  type: comment
  z: b1782abc.430f38
  name: Teleinfo Events
  info: ''
  x: 120
  'y': 750
  wires: []
- id: 1f15f03f0befad41
  type: link out
  z: b1782abc.430f38
  name: link out 1
  mode: link
  links:
    - 96a4ca6603fc71d9
  x: 425
  'y': 380
  wires: []
- id: 7acfda68aa284e84
  type: delay
  z: b1782abc.430f38
  name: ''
  pauseType: queue
  timeout: '30'
  timeoutUnits: seconds
  rate: '1'
  nbRateUnits: '1'
  rateUnits: second
  randomFirst: '1'
  randomLast: '5'
  randomUnits: seconds
  drop: true
  allowrate: false
  outputs: 1
  x: 460
  'y': 750
  wires:
    - []
- id: 9f6adedc9ca772ef
  type: switch
  z: b1782abc.430f38
  name: ''
  property: topic
  propertyType: msg
  rules:
    - t: eq
      v: HCHC
      vt: str
    - t: eq
      v: HCHP
      vt: str
    - t: eq
      v: PAPP
      vt: str
    - t: eq
      v: PTEC
      vt: str
    - t: else
  checkall: 'false'
  repair: false
  outputs: 5
  x: 650
  'y': 800
  wires:
    - - 83829b3a37df4617
    - - 83829b3a37df4617
    - - 37aa0a253b8b6972
    - - ad886e91c50e5db5
    - - 7e1ec77294b7e482
- id: 83829b3a37df4617
  type: function
  z: b1782abc.430f38
  name: Insert Wh HC/HP/Total
  func: |-
    var teleinfoHC = global.get("tidhome_teleinfo.HCHC")
    var teleinfoHP = global.get("tidhome_teleinfo.HCHP")
    var teleinfoTotal = Number(teleinfoHC + teleinfoHP)

    // HCHC
    let fieldsHC = { "value": teleinfoHC }
    let tagsHC =   { "type": "teleinfo-HCHC", "location": "main" }

    var msgHCHC =  {
        topic: "teleinfo-HCHC",
        payload: {
            payload: [ fieldsHC, tagsHC ],
            measurement: "sensors"
        }
    }

    // HPHP
    let fieldsHP = { "value": teleinfoHP }
    let tagsHP =   { "type": "teleinfo-HCHP", "location": "main" }

    var msgHCHP =  {
        topic: "teleinfo-HCHP",
        payload: {
            payload: [ fieldsHP, tagsHP ],
            measurement: "sensors"
        }
    }

    // Total
    let fieldsTotal = { "value": teleinfoTotal }
    let tagsTotal =   { "type": "teleinfo-Wh-Total", "location": "main" }

    var msgTotal =  {
        topic: "teleinfo-Wh-Total",
        payload: {
            payload: [ fieldsTotal, tagsTotal ],
            measurement: "sensors"
        }
    }

    return [
        msgHCHC,
        msgHCHP,
        msgTotal
        ]
  outputs: 3
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 1020
  'y': 760
  wires:
    - - 0edaade20969311b
    - - 0edaade20969311b
    - - 0edaade20969311b
- id: ad886e91c50e5db5
  type: function
  z: b1782abc.430f38
  name: PTEC
  func: |-
    // convert to current hour costs to boolean
    let valueInt = (msg.payload == 'HC..') ? 1 : 0
    global.set("tidhome_teleinfo.PTEC_HC", valueInt);
    return { topic: "PTEC_HC", payload: valueInt }
  outputs: 1
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 810
  'y': 830
  wires:
    - - 37aa0a253b8b6972
- id: 37aa0a253b8b6972
  type: function
  z: b1782abc.430f38
  name: Insert Query
  func: |-
    let fields = { "value": Number(msg.payload) }
    let tags =   { "type": "teleinfo-" + msg.topic, "location": "main" }

    var msgres =  {
        topic: "teleinfo-" + msg.topic,
        payload: {
            payload: [ fields, tags ],
            measurement: "sensors"
        }
    }

    return msgres;
  outputs: 1
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 990
  'y': 810
  wires:
    - - 0edaade20969311b
- id: 7e1ec77294b7e482
  type: function
  z: b1782abc.430f38
  name: IsNumeric
  func: |
    function isNumeric(n) { 
        return !isNaN(parseFloat(n)) && isFinite(n); 
    }

    // convert to numeric if possible
    if (isNumeric(msg.payload)) {
        return { topic: msg.topic, payload: msg.payload }
    }
  outputs: 1
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 820
  'y': 870
  wires:
    - - 37aa0a253b8b6972
